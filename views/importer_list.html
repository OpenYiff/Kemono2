{% extends 'components/shell.html' %}
{% block content %}
<div class="page" id="page">
  <h1>Import from paysite</h1>
  <form
    class="importer-form"
    action="/api/import"
    enctype="application/x-www-form-urlencoded"
    method="post"
    onsubmit="return (typeof submitted == 'undefined') ? (submitted = true) : !submitted"
  >
    <select id="service" name="service">
      <option value="patreon" selected>Patreon</option>
      <option value="fanbox">Pixiv Fanbox</option>
      <option value="gumroad">Gumroad</option>
      <option value="subscribestar">SubscribeStar</option>
      <option value="discord" disabled>Discord</option>
      <option value="dlsite" disabled >DLsite English</option>
      <option value="dlsite-jp" disabled>DLsite Japan</option>
    </select>
    <input 
      type="text"
      name="session_key"
      placeholder="session key"
      autocomplete="off" 
      autocorrect="off" 
      autocapitalize="off" 
      spellcheck="false"
      required
    >
    <input 
      type="text"
      id="channel_ids"
      name="channel_ids"
      placeholder="discord channel ids (comma separated, no spaces)"
      autocomplete="off" 
      autocorrect="off" 
      autocapitalize="off" 
      spellcheck="false"
    >
    <input type="submit"/>
    <div id="consent" style="width:100%;margin-top:5px">
      <input type="checkbox" checked="checked" id="save-session-key" name="save_session_key" value="1" style="display:inline;margin-right:5px"/>
      <label for="save-session-key" style="display:inline">I want to allow the development team to use my session for debugging (your session will be encrypted)</label>
    </div>
  </form>
  <p>
    <span class="subtitle">Discord and DLsite importers are unimplemented. Sorry for the inconvenience.</span><br>
    <a href="/importer/tutorial">Learn how to get your session key.</a><br>
    <h2>Important information</h2>
    Your session key is used to scrape paid posts from your feed. After downloading missing posts, the key is immediately discarded and never stored.
    <h3>DLsite</h3>
    <ul>
      <li>The English and Japanese versions of DLsite are separate, and have different APIs and login systems. Make sure to select the right one!</li>
      <li>As of right now, the importer is unable to crack DRM-protected works from DLsite. (extensions .dlst and .cpd) These will not be downloaded.</li>
      <li>DLsite has a short token expiration period. If your import fails, try getting a new token by logging out and back in.</li>
    </ul>
    If you're having trouble with the importer, <a href="mailto:admin@kemono.party">contact admin.</a> 
  </p>
</div>
<script src="/static/js/importer.js"></script>
{% endblock %}